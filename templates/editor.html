{% extends "base.html" %}
{% block content %}
<section class="ae-workspace">
  <form id="editor-form" method="post" action="/process" enctype="multipart/form-data">
    <div class="ae-topbar ui-card">
      <div class="ae-brand">Reelve Editor</div>
      <div class="ae-actions">
        <button id="editor-export" class="btn btn-primary btn-sm" type="button">Export</button>
      </div>
    </div>

    <div class="ae-body">
      <aside class="ae-panel ui-panel ae-left">
        <h6 class="panel-title">Project</h6>
        <label class="form-label mt-2">Media File</label>
        <input id="media-input" class="form-control" type="file" name="file" required>

        <label class="form-label mt-3">Mode</label>
        <select id="mode-select" class="form-select" name="mode">
          <option value="video" selected>Video</option>
          <option value="image">Image</option>
        </select>

        <label class="form-label mt-3">Action</label>
        <select class="form-select" name="action">
          <option value="edits" selected>Custom Edits</option>
          <option value="autocut">AutoCut + Optional Edits</option>
        </select>
        <div class="form-text text-muted">AutoCut uses silence detection. You can still add edits.</div>

        <label class="form-label mt-3">Template</label>
        <select id="template-select" class="form-select" name="template">
          <option value="">None</option>
          {% for t in templates %}
            <option value="{{ t.id }}">{{ t.name }}</option>
          {% endfor %}
        </select>

        <hr class="border-secondary my-3">
        <h6 class="panel-title">Canvas</h6>
        <select id="ed-canvas-preset" class="form-select mt-2">
          <option value="1080,1080">Square (1080x1080)</option>
          <option value="1080,1350">Portrait (1080x1350)</option>
          <option value="1080,1920">Story/Reel (1080x1920)</option>
          <option value="1200,628">Facebook (1200x628)</option>
          <option value="1920,1080">YouTube (1920x1080)</option>
          <option value="custom" selected>Custom</option>
        </select>
        <div class="d-flex gap-2 mt-2">
          <input id="ed-canvas-width" class="form-control" placeholder="Width" value="1080">
          <input id="ed-canvas-height" class="form-control" placeholder="Height" value="1080">
        </div>
        <button type="button" id="ed-apply-canvas" class="btn btn-outline-light btn-sm w-100 mt-2">Apply Size</button>

        <hr class="border-secondary my-3">
        <h6 class="panel-title">Assets</h6>
        <div class="small text-muted">Add images and layers via the toolbar.</div>
      </aside>

      <main class="ae-center">
        <div class="ae-toolbar ui-toolbar">
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn active" data-tool="select">Select</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="text">Text</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="image">Image</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="shape">Shape</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="line">Line</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="curve">Curve</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="pen">Pen</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="marker">Marker</button>
          <button type="button" class="btn btn-sm btn-outline-light ed-tool-btn" data-tool="eraser">Eraser</button>
        </div>

        <div class="ae-canvas-wrap">
          <div class="ae-preview">
            <video id="video-preview" class="preview-media d-none" controls></video>
            <img id="image-preview" class="preview-media d-none" alt="Preview">
            <div class="design-canvas" id="ed-design-canvas">
              <canvas id="ed-draw-layer"></canvas>
              <div class="layer text-layer" contenteditable="true" style="top:40px;left:40px;">Your Headline</div>
            </div>
          </div>
        </div>

        <div class="ae-timeline">
          <div class="timeline-header">Timeline</div>
          <div class="timeline-track">Add images/video to build sequences (duration support coming).</div>
        </div>
      </main>

      <aside class="ae-panel ui-panel ae-right">
        <h6 class="panel-title">Properties</h6>
        <label class="form-label mt-2">Speed</label>
        <input id="speed" type="range" class="form-range" min="0.5" max="2" step="0.05" value="1">

        <label class="form-label mt-2">Brightness</label>
        <input id="brightness" type="range" class="form-range" min="0.5" max="1.8" step="0.05" value="1">

        <label class="form-label mt-2">Contrast</label>
        <input id="contrast" type="range" class="form-range" min="0.6" max="1.6" step="0.05" value="1">

        <label class="form-label mt-2">Saturation</label>
        <input id="saturation" type="range" class="form-range" min="0" max="2" step="0.05" value="1">

        <label class="form-label mt-2">Blur</label>
        <input id="blur" type="range" class="form-range" min="0" max="6" step="0.5" value="0">

        <label class="form-label mt-2">Text</label>
        <input id="text" class="form-control" value="Your Brand">

        <label class="form-label mt-2">Text Size</label>
        <input id="font-size" type="range" class="form-range" min="24" max="96" step="2" value="48">

        <label class="form-label mt-2">Text Color</label>
        <input id="text-color" type="color" class="form-control form-control-color" value="#ffffff">

        <hr class="border-secondary my-3">
        <h6 class="panel-title">Design Tools</h6>
        <label class="form-label mt-2">Shape</label>
        <select id="ed-shape-type" class="form-select">
          <option value="rect" selected>Rectangle</option>
          <option value="circle">Circle</option>
          <option value="triangle">Triangle</option>
          <option value="heart">Heart</option>
          <option value="star">Star</option>
          <option value="moon">Moon</option>
          <option value="diamond">Diamond</option>
          <option value="hexagon">Hexagon</option>
          <option value="pentagon">Pentagon</option>
          <option value="arrow">Arrow</option>
          <option value="speech">Speech Bubble</option>
          <option value="cross">Cross</option>
          <option value="blob">Blob</option>
          <option value="ring">Ring</option>
          <option value="burst">Burst</option>
          <option value="cloud">Cloud</option>
          <option value="chevron">Chevron</option>
          <option value="pill">Pill</option>
          <option value="parallelogram">Parallelogram</option>
          <option value="ticket">Ticket</option>
        </select>

        <label class="form-label mt-3">Font</label>
        <select id="ed-font-family" class="form-select">
          <option value="Poppins" selected>Poppins</option>
          <option value="Montserrat">Montserrat</option>
          <option value="Oswald">Oswald</option>
          <option value="Playfair Display">Playfair Display</option>
          <option value="Bebas Neue">Bebas Neue</option>
          <option value="Raleway">Raleway</option>
          <option value="Nunito">Nunito</option>
          <option value="Rubik">Rubik</option>
          <option value="Lato">Lato</option>
          <option value="Fira Sans">Fira Sans</option>
          <option value="Anton">Anton</option>
          <option value="DM Serif Display">DM Serif Display</option>
          <option value="Abril Fatface">Abril Fatface</option>
          <option value="Pacifico">Pacifico</option>
          <option value="Source Sans 3">Source Sans 3</option>
          <option value="Source Serif 4">Source Serif 4</option>
          <option value="Manrope">Manrope</option>
          <option value="Work Sans">Work Sans</option>
          <option value="Archivo">Archivo</option>
          <option value="Quicksand">Quicksand</option>
          <option value="Karla">Karla</option>
          <option value="Josefin Sans">Josefin Sans</option>
          <option value="Mulish">Mulish</option>
          <option value="Barlow">Barlow</option>
          <option value="Zilla Slab">Zilla Slab</option>
          <option value="Space Grotesk">Space Grotesk</option>
          <option value="Kanit">Kanit</option>
          <option value="Cabin">Cabin</option>
          <option value="Cinzel">Cinzel</option>
          <option value="Alfa Slab One">Alfa Slab One</option>
          <option value="Chivo">Chivo</option>
          <option value="Inter">Inter</option>
          <option value="Georgia">Georgia</option>
        </select>

        <label class="form-label mt-3">Font Size</label>
        <input id="ed-font-size" type="range" class="form-range" min="12" max="140" value="48">

        <label class="form-label mt-3">Text Style</label>
        <div class="d-flex gap-2">
          <button type="button" id="ed-text-bold" class="btn btn-sm btn-outline-light">Bold</button>
          <button type="button" id="ed-text-italic" class="btn btn-sm btn-outline-light">Italic</button>
          <button type="button" id="ed-text-upper" class="btn btn-sm btn-outline-light">Uppercase</button>
        </div>

        <label class="form-label mt-3">Text Color</label>
        <input id="ed-text-color" type="color" class="form-control form-control-color" value="#ffffff">

        <label class="form-label mt-3">Letter Spacing</label>
        <input id="ed-letter-spacing" type="range" class="form-range" min="0" max="10" value="0">

        <label class="form-label mt-3">Line Height</label>
        <input id="ed-line-height" type="range" class="form-range" min="0.8" max="2" step="0.1" value="1.2">

        <label class="form-label mt-3">Fill Color</label>
        <input id="ed-fill-color" type="color" class="form-control form-control-color" value="#3b82f6">

        <label class="form-label mt-3">Stroke Color</label>
        <input id="ed-stroke-color" type="color" class="form-control form-control-color" value="#0f172a">

        <label class="form-label mt-3">Stroke Width</label>
        <input id="ed-stroke-width" type="range" class="form-range" min="1" max="20" value="2">

        <label class="form-label mt-3">Rotate</label>
        <input id="ed-rotate" type="range" class="form-range" min="-180" max="180" value="0">

        <label class="form-label mt-3">Background</label>
        <input id="ed-bg-color" type="color" class="form-control form-control-color" value="#111827">

        <label class="form-label mt-3">Brush Size</label>
        <input id="ed-brush-size" type="range" class="form-range" min="2" max="30" value="6">

        <div class="form-check mt-3">
          <input id="ed-draw-on-selection" class="form-check-input" type="checkbox">
          <label class="form-check-label" for="ed-draw-on-selection">Draw on Selected Layer</label>
        </div>

        <label class="form-label mt-3">Layer Order</label>
        <div class="d-flex gap-2">
          <button type="button" id="ed-bring-front" class="btn btn-sm btn-outline-light">Bring Front</button>
          <button type="button" id="ed-send-back" class="btn btn-sm btn-outline-light">Send Back</button>
        </div>

        <div class="d-grid gap-2 mt-4">
          <input id="ed-image-upload" class="form-control" type="file" accept="image/*">
          <button type="button" id="ed-delete-layer" class="btn btn-outline-danger">Delete Selected</button>
        </div>
      </aside>
    </div>

    <textarea id="edits-json" class="d-none" name="edits"></textarea>
  </form>
</section>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="{{ url_for('static', filename='js/editor.js') }}"></script>
<script src="{{ url_for('static', filename='js/designer_core.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor_designer.js') }}"></script>
{% endblock %}
